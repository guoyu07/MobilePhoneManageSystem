webpackJsonp([22],{224:function(e,t,a){function o(e){a(346)}var l=a(51)(a(275),a(381),o,"data-v-4d592c53",null);e.exports=l.exports},249:function(e,t,a){e.exports={default:a(250),__esModule:!0}},250:function(e,t,a){var o=a(6),l=o.JSON||(o.JSON={stringify:JSON.stringify});e.exports=function(e){return l.stringify.apply(l,arguments)}},251:function(e,t,a){"use strict";function o(e,t){var a=void 0;return function(){for(var o=this,l=arguments.length,r=Array(l),n=0;n<l;n++)r[n]=arguments[n];a&&clearTimeout(a),a=setTimeout(function(){e.apply(o,r)},t)}}function l(e,t){t=t>0&&t<=20?t:2,e=parseFloat((e+"").replace(/[^\d.-]/g,"")).toFixed(t)+"";for(var a=e.split(".")[0].split("").reverse(),o=e.split(".")[1],l="",r=0;r<a.length;r++)l+=a[r]+((r+1)%3==0&&r+1!==a.length?",":"");return l.split("").reverse().join("")+"."+o}function r(){var e=(0,n.getToken)();if(!e)return!1;var t=s.TokenUtil.parseUuid(e);return"-"===t.charAt(t.length-1)}Object.defineProperty(t,"__esModule",{value:!0}),t.debounce=o,t.formatMoney=l,t.isSuperAdmin=r;var n=a(22),s=a(22)},275:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(249),r=o(l),n=a(90),s=o(n),d=a(23),i=o(d),c=a(87),m=a(251),u=a(54);t.default={data:function(){var e=function(e,t,a){t?/^\w{5,18}$/.test(t)?a():a(new Error("用户名必须由5-18位数字、字母、下划线组成")):a(new Error("请输入用户名"))},t=function(e,t,a){t?/^.{5,18}$/.test(t)?a():a(new Error("密码长度必须为5-18位")):a(new Error("请输入密码"))};return{searchForm:{name:"",dept:""},relateForm:{username:this.username||"",password:""},addForm:{name:"",tel:"",type:!0,dept:"",remark:"",username:""},employees:[],deletedEmployees:[],depts:[],currentEmpId:"",relateFormVisible:!1,addFormVisible:!1,loading:!0,loadingDeleted:!0,showDeleted:!1,pageIndex:1,pageSize:10,count:0,loginRule:{username:[{validator:e,trigger:"blur"}],password:[{validator:t,trigger:"blur"}]},addRule:{}}},computed:(0,s.default)({searchFormJson:function(){return(0,r.default)(this.searchForm)}},(0,u.mapGetters)(["username"])),watch:{searchFormJson:(0,m.debounce)(function(){this.getEmployees()},500),$route:"getEmployees"},methods:{getEmployees:function(e){e%1!=0&&(e=null),this.loading=!0;var t=this,a=c.backEndUrl+"/employee/get_employees.do";i.default.post(a,(0,r.default)({name:t.searchForm.name,dept:t.searchForm.dept,pageIndex:e||t.pageIndex,pageSize:10}),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(e){e.data.status===c.SUCCESS?(t.employees=e.data.data,t.count=e.data.count,t.loading=!1):t.$message.error(e.data.msg)})},addEmployee:function(){this.addFormVisible=!0},onAddSubmit:function(){var e=this,t=c.backEndUrl+"/employee/add_employee.do";i.default.post(t,(0,r.default)({name:e.addForm.name,tel:e.addForm.tel,type:e.addForm.type?"SALES":"OTHER",dept:e.addForm.dept,remark:e.addForm.remark}),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(t){t.data.status===c.SUCCESS?(e.$message.success("添加成功"),e.getEmployees(),e.addFormVisible=!1):e.$message.error(t.data.msg)})},deleteEmployee:function(e){var t=this,a=c.backEndUrl+"/employee/delete_employee.do";this.$confirm("此操作将删除员工, 是否继续？（可操作数据库进行恢复）","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"danger"}).then(function(){i.default.get(a,{params:{id:e.id}}).then(function(e){e.data.status===c.SUCCESS?(t.getEmployees(),t.$message({type:"success",message:"删除成功!"})):t.$message({type:"error",message:e.data.msg})})}).catch(function(){})},editEmployee:function(e){this.$router.push("/employee_manage/"+e.id)},recoverEmployee:function(e){var t=this,a=c.backEndUrl+"/employee/recover_employee.do";i.default.get(a,{params:{id:e.id}}).then(function(e){e.data.status===c.SUCCESS&&(t.getEmployees(),t.getDeletedEmployees(),t.$message.success("恢复成功"))})},getDeletedEmployees:function(){this.showDeleted=!0,this.loadingDeleted=!0;var e=this,t=c.backEndUrl+"/employee/get_deleted_employees.do";i.default.get(t,{params:{}}).then(function(t){t.data.status===c.SUCCESS&&(e.deletedEmployees=t.data.data,e.loadingDeleted=!1)})},getDepts:function(){var e=this,t=c.backEndUrl+"/dept/get_depts.do";i.default.get(t,{params:{}}).then(function(t){t.data.status===c.SUCCESS&&(e.depts=t.data.data)})},selectShowed:function(e){e&&0===this.depts.length&&this.getDepts()},hideRecover:function(){this.showDeleted=!1,this.loadingDeleted=!1},relateUser:function(e){this.currentEmpId=e.id,this.relateFormVisible=!0},relateSubmit:function(){var e=this,t=this,a=c.backEndUrl+"/employee/relate_user.do";i.default.post(a,(0,r.default)({id:t.currentEmpId,username:t.relateForm.username,password:t.relateForm.password}),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(a){a.data.status===c.SUCCESS?(e.relateFormVisible=!1,t.$message.success("关联成功"),t.getEmployees()):t.$message.error(a.data.msg)})},unrelateUser:function(e){var t=this,a=c.backEndUrl+"/employee/unrelate_user.do";this.$confirm("此操作将解除关联账号, 是否继续？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"danger"}).then(function(){i.default.get(a,{params:{id:e.id}}).then(function(e){e.data.status===c.SUCCESS?(t.getEmployees(),t.$message({type:"success",message:"解除成功!"})):t.$message({type:"error",message:"解除失败!"})})}).catch(function(){})}},mounted:function(){this.relateForm.username=this.username||"",this.getEmployees()}}},313:function(e,t,a){t=e.exports=a(214)(!0),t.push([e.i,".form2[data-v-4d592c53]{margin:100px 0}.el-table .deleted-row[data-v-4d592c53]{background-color:rgba(255,73,73,.56)}.recover[data-v-4d592c53]{float:right;margin:10px 40px 10px 0}.add[data-v-4d592c53]{float:left;margin:10px 40px 10px 10px}h1[data-v-4d592c53],h2[data-v-4d592c53],h3[data-v-4d592c53]{margin:30px}","",{version:3,sources:["D:/Documents/webstormworkspace/ManageSystem/src/components/base_config/EmployeeManage.vue"],names:[],mappings:"AAGA,wBACE,cAAgB,CACjB,AACD,wCACE,oCAA0C,CAC3C,AACD,0BACE,YAAa,AACb,uBAAyB,CAC1B,AACD,sBACE,WAAY,AACZ,0BAA4B,CAC7B,AACD,4DACE,WAAa,CACd",file:"EmployeeManage.vue",sourcesContent:["\n.employee-manage[data-v-4d592c53] {\n}\n.form2[data-v-4d592c53] {\n  margin: 100px 0;\n}\n.el-table .deleted-row[data-v-4d592c53] {\n  background-color: rgba(255, 73, 73, 0.56);\n}\n.recover[data-v-4d592c53] {\n  float: right;\n  margin: 10px 40px 10px 0;\n}\n.add[data-v-4d592c53] {\n  float: left;\n  margin: 10px 40px 10px 10px;\n}\nh1[data-v-4d592c53], h2[data-v-4d592c53], h3[data-v-4d592c53] {\n  margin: 30px;\n}\n"],sourceRoot:""}])},346:function(e,t,a){var o=a(313);"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);a(215)("2ee4465d",o,!0)},381:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"employee-manage"},[a("h2",[e._v("员工管理")]),e._v(" "),a("el-button",{staticClass:"add",attrs:{size:"small"},on:{click:e.addEmployee}},[a("i",{staticClass:"el-icon-plus"}),e._v(" 添加新员工")]),e._v(" "),a("div",{staticClass:"search"},[a("el-form",{attrs:{inline:!0,model:e.searchForm}},[a("el-form-item",{attrs:{label:"员工姓名"}},[a("el-input",{attrs:{placeholder:"员工姓名"},model:{value:e.searchForm.name,callback:function(t){e.searchForm.name=t},expression:"searchForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"部门"}},[a("el-select",{attrs:{placeholder:"部门"},on:{"visible-change":e.selectShowed},model:{value:e.searchForm.dept,callback:function(t){e.searchForm.dept=t},expression:"searchForm.dept"}},[a("el-option",{attrs:{label:"所有部门",value:""}}),e._v(" "),e._l(e.depts,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.name}})})],2)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.getEmployees}},[e._v("查询")])],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.loading,expression:"loading",modifiers:{body:!0}}],staticStyle:{width:"100%"},attrs:{data:e.employees,align:"left","default-sort":{prop:"dept.name",order:"descending"}}},[a("el-table-column",{staticClass:"column",attrs:{prop:"name",sortable:"",label:"员工名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"tel",label:"电话"}}),e._v(" "),a("el-table-column",{attrs:{prop:"type",sortable:"",label:"类别"}}),e._v(" "),a("el-table-column",{attrs:{prop:"dept.name",sortable:"",label:"部门"}}),e._v(" "),a("el-table-column",{attrs:{prop:"remark",label:"备注"}}),e._v(" "),a("el-table-column",{attrs:{prop:"user.username",label:"账号"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.user?t.row.user.username:"[无]")+"\n          "),t.row.user?e._e():a("el-button",{attrs:{size:"small"},on:{click:function(a){e.relateUser(t.row)}}},[e._v("关联账号\n          ")]),e._v(" "),t.row.user?a("el-button",{attrs:{size:"small"},on:{click:function(a){e.unrelateUser(t.row)}}},[e._v("解除关联\n          ")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{plain:!0,type:"info",icon:"edit",size:"small"},on:{click:function(a){e.editEmployee(t.row)}}}),e._v(" "),a("el-button",{attrs:{plain:!0,type:"danger",icon:"delete",size:"small"},on:{click:function(a){e.deleteEmployee(t.row)}}})]}}])})],1),e._v(" "),a("el-pagination",{staticClass:"pagination",attrs:{layout:"prev, pager, next",total:e.count,"current-page":e.pageIndex,"page-size":e.pageSize},on:{"current-change":e.getEmployees}}),e._v(" "),a("div",{staticClass:"recover"},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.showDeleted,expression:"!showDeleted"}],attrs:{plain:!0,type:"info"},on:{click:e.getDeletedEmployees}},[e._v("显示已删除员工")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.showDeleted,expression:"showDeleted"}],attrs:{plain:!0,type:"info"},on:{click:e.hideRecover}},[e._v("隐藏已删除员工")])],1),e._v(" "),e.showDeleted?a("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.loadingDeleted,expression:"loadingDeleted",modifiers:{body:!0}}],staticClass:"form2",staticStyle:{width:"100%"},attrs:{data:e.deletedEmployees,"row-class-name":"deleted-row",align:"left","default-sort":{prop:"dept.name",order:"descending"}}},[a("el-table-column",{staticClass:"column",attrs:{prop:"name",label:"员工名称",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"tel",label:"电话"}}),e._v(" "),a("el-table-column",{attrs:{prop:"type",label:"类别",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"dept.name",label:"部门",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"remark",label:"备注"}}),e._v(" "),a("el-table-column",{attrs:{prop:"user",label:"账号"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"small"},on:{click:function(a){e.recoverEmployee(t.row)}}},[e._v("恢复\n          ")])]}}])})],1):e._e()],1),e._v(" "),a("el-dialog",{attrs:{title:"关联账号",visible:e.relateFormVisible},on:{"update:visible":function(t){e.relateFormVisible=t}}},[a("el-form",{attrs:{model:e.relateForm,rules:e.loginRule,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"用户名",prop:"username"}},[a("el-input",{attrs:{type:"text"},model:{value:e.relateForm.username,callback:function(t){e.relateForm.username=t},expression:"relateForm.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.relateForm.password,callback:function(t){e.relateForm.password=t},expression:"relateForm.password"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.relateFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.relateSubmit}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"新建员工",visible:e.addFormVisible},on:{"update:visible":function(t){e.addFormVisible=t}}},[a("el-form",{attrs:{model:e.addForm,rules:e.addRule,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"员工姓名"}},[a("el-input",{model:{value:e.addForm.name,callback:function(t){e.addForm.name=t},expression:"addForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"电话"}},[a("el-input",{model:{value:e.addForm.tel,callback:function(t){e.addForm.tel=t},expression:"addForm.tel"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"类别"}},[a("el-switch",{attrs:{width:80,"on-text":"销售员","off-text":"其他"},model:{value:e.addForm.type,callback:function(t){e.addForm.type=t},expression:"addForm.type"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"部门"}},[a("el-select",{attrs:{placeholder:"请选择部门"},on:{"visible-change":e.selectShowed},model:{value:e.addForm.dept,callback:function(t){e.addForm.dept=t},expression:"addForm.dept"}},[a("el-option",{attrs:{label:"未定",value:""}}),e._v(" "),e._l(e.depts,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.name}})})],2)],1),e._v(" "),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.addForm.remark,callback:function(t){e.addForm.remark=t},expression:"addForm.remark"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.onAddSubmit}},[e._v("确 定")])],1)],1),e._v(" "),a("router-view")],1)},staticRenderFns:[]}}});
//# sourceMappingURL=22.3e834cb77e5b55a38255.js.map