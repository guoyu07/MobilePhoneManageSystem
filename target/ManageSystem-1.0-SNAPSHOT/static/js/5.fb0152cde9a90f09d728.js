webpackJsonp([5],{241:function(e,t,n){function a(e){n(355)}var o=n(51)(n(292),n(390),a,"data-v-783acce8",null);e.exports=o.exports},249:function(e,t,n){e.exports={default:n(250),__esModule:!0}},250:function(e,t,n){var a=n(6),o=a.JSON||(a.JSON={stringify:JSON.stringify});e.exports=function(e){return o.stringify.apply(o,arguments)}},256:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"ElButton",props:{type:{type:String,default:"default"},size:String,icon:{type:String,default:""},nativeType:{type:String,default:"button"},loading:Boolean,disabled:Boolean,plain:Boolean,autofocus:Boolean},methods:{handleClick:function(e){this.$emit("click",e)},handleInnerClick:function(e){this.disabled&&e.stopPropagation()}}}},257:function(e,t,n){e.exports={default:n(258),__esModule:!0}},258:function(e,t,n){n(53),n(52),e.exports=n(259)},259:function(e,t,n){var a=n(10),o=n(89);e.exports=n(6).getIterator=function(e){var t=o(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return a(t.call(e))}},260:function(e,t,n){var a=n(51)(n(256),n(261),null,null,null);e.exports=a.exports},261:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("button",{staticClass:"el-button",class:[e.type?"el-button--"+e.type:"",e.size?"el-button--"+e.size:"",{"is-disabled":e.disabled,"is-loading":e.loading,"is-plain":e.plain}],attrs:{disabled:e.disabled,autofocus:e.autofocus,type:e.nativeType},on:{click:e.handleClick}},[e.loading?n("i",{staticClass:"el-icon-loading",on:{click:e.handleInnerClick}}):e._e(),e._v(" "),e.icon&&!e.loading?n("i",{class:"el-icon-"+e.icon,on:{click:e.handleInnerClick}}):e._e(),e._v(" "),e.$slots.default?n("span",{on:{click:e.handleInnerClick}},[e._t("default")],2):e._e()])},staticRenderFns:[]}},292:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(257),r=a(o),s=n(249),i=a(s),l=n(23),c=a(l),u=n(87),d=n(260),f=a(d);t.default={components:{ElButton:f.default},data:function(){return{props:{label:"name",children:"children"},role:{},rawMenus:[],menus:[],roles:[],authorized:[],expanded:[],loading:!1}},methods:{test:function(){var e={};console.log((0,i.default)(e)),(0,i.default)("{}"===e)&&console.log("ok1"),e&&console.log("ok2"),console.log("avvc#fewf#aaa".split("#")[0]),console.log(this.authorized),console.log(this.menus)},submit:function(){var e=this,t=this.parseMenuIds(this.$refs.tree.getCheckedKeys()),n=this.parseActionUrls(this.$refs.tree.getCheckedKeys()),a=this,o=u.backEndUrl+"/menu/update_menus_from_role.do",r=u.backEndUrl+"/action/update_actions_from_role.do";c.default.post(o,(0,i.default)({menuIds:t,role:a.role}),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(e){e.data.status===u.SUCCESS?a.$message.success("提交成功"):a.$message.error(e.data.msg)}),c.default.post(r,(0,i.default)({actionUrls:n,role:a.role}),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(t){t.data.status===u.SUCCESS?(a.$message.success("提交成功"),e.getMenus()):a.$message.error(t.data.msg)})},getMenus:function(){this.loading=!0,this.authorized=[],this.expanded=[];var e=this,t=u.backEndUrl+"/menu/get_menus.do";c.default.get(t,{params:{}}).then(function(t){t.data.status===u.SUCCESS?(e.rawMenus=t.data.data,e.menus=e.parseRawMenus(e.rawMenus),e.loading=!1):e.$message.error(t.data.msg)})},parseRawMenus:function(e){var t=JSON.parse((0,i.default)(e)),n=!0,a=!1,o=void 0;try{for(var s,l=(0,r.default)(t);!(n=(s=l.next()).done);n=!0){var c=s.value,u=!0,d=!1,f=void 0;try{for(var p,h=(0,r.default)(c.children);!(u=(p=h.next()).done);u=!0){var v=p.value;if("NODE"===v.type){this.checkRoleThenAuthorizeNode(v),v.children=v.actions;var g=!0,m=!1,y=void 0;try{for(var C,_=(0,r.default)(v.actions);!(g=(C=_.next()).done);g=!0){var k=C.value;k.id=k.url+"#"+v.id,this.checkRoleThenAuthorizeNode(k)}}catch(e){m=!0,y=e}finally{try{!g&&_.return&&_.return()}finally{if(m)throw y}}}}}catch(e){d=!0,f=e}finally{try{!u&&h.return&&h.return()}finally{if(d)throw f}}this.expanded.push(c.id)}}catch(e){a=!0,o=e}finally{try{!n&&l.return&&l.return()}finally{if(a)throw o}}return t},parseMenuIds:function(e){return e.filter(function(e){return"/"!==e[0]})},parseActionUrls:function(e){var t=e.filter(function(e){return"/"===e[0]});for(var n in t)t[n]=t[n].split("#")[0];t.sort();for(var a=t.length-1;a>0;a--)t[a]===t[a-1]&&t.splice(a,1);return t},getRoles:function(){var e=this,t=u.backEndUrl+"/role/get_roles.do";c.default.get(t,{}).then(function(t){t.data.status===u.SUCCESS?e.roles=t.data.data:e.$message.error(t.data.msg)})},checkRoleThenAuthorizeNode:function(e){var t=!0,n=!1,a=void 0;try{for(var o,s=(0,r.default)(e.roles);!(t=(o=s.next()).done);t=!0){o.value.id===this.role.id&&this.authorized.push(e.id)}}catch(e){n=!0,a=e}finally{try{!t&&s.return&&s.return()}finally{if(n)throw a}}}},mounted:function(){this.getRoles()}}},322:function(e,t,n){t=e.exports=n(214)(!0),t.push([e.i,".form2[data-v-783acce8]{margin:100px 0}h1[data-v-783acce8],h2[data-v-783acce8],h3[data-v-783acce8]{margin:30px}.tree[data-v-783acce8]{margin:20px 0}","",{version:3,sources:["D:/Documents/webstormworkspace/ManageSystem/src/components/system_manage/AuthManage.vue"],names:[],mappings:"AACA,wBACE,cAAgB,CACjB,AACD,4DACE,WAAa,CACd,AACD,uBACE,aAAe,CAChB",file:"AuthManage.vue",sourcesContent:["\n.form2[data-v-783acce8] {\n  margin: 100px 0;\n}\nh1[data-v-783acce8], h2[data-v-783acce8], h3[data-v-783acce8] {\n  margin: 30px;\n}\n.tree[data-v-783acce8] {\n  margin: 20px 0;\n}\n\n"],sourceRoot:""}])},355:function(e,t,n){var a=n(322);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);n(215)("85218dfc",a,!0)},390:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"auth-manage"},[n("h2",[e._v("权限管理")]),e._v(" "),n("el-select",{attrs:{placeholder:"请选择角色",valueKey:"id"},on:{change:e.getMenus},model:{value:e.role,callback:function(t){e.role=t},expression:"role"}},e._l(e.roles,function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e}})})),e._v(" "),n("el-tree",{directives:[{name:"loading",rawName:"v-loading.body",value:e.loading,expression:"loading",modifiers:{body:!0}}],ref:"tree",staticClass:"tree",attrs:{data:e.menus,props:e.props,"empty-text":"请先选择您需要管理权限的角色",showCheckbox:"","check-strictly":!0,"default-checked-keys":e.authorized,"default-expanded-keys":e.expanded,nodeKey:"id"}}),e._v(" "),n("div",{staticClass:"buttons"},[n("el-button",{on:{click:e.getMenus}},[e._v("重置")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("提交")])],1)],1)},staticRenderFns:[]}}});
//# sourceMappingURL=5.fb0152cde9a90f09d728.js.map